6_autoupdate/autoupdate.sh — главный оркестратор, выполняет 3 этапа:
Сканирование источника — запускает 2_knowledge_base/get_witcher_wiki.py для загрузки/обновления .md-файлов с Ведьмак-вики
Обновление индекса — вызывает update_index.py (чанкинг, эмбеддинги, запись в ChromaDB)
Очистка — ротация старых логов (хранятся последние 10)
Весь вывод дублируется в 6_autoupdate/logs/autoupdate_YYYYMMDD_HHMMSS.log.
6_autoupdate/update_index.py — инкрементальное обновление индекса:
Манифест (.manifest.json) хранит MD5-хеши всех файлов после последнего обновления
Сканирование — сравнивает текущие файлы с манифестом и выявляет новые, изменённые и удалённые документы
Новые файлы — чанкятся (SentenceChunker, 300 символов, overlap 50) и upsert-ятся в ChromaDB
Изменённые файлы — старые чанки удаляются, новые upsert-ятся
Удалённые файлы — их чанки удаляются из коллекции
Без изменений — если ни один файл не изменился, скрипт завершается мгновенно
Параметры (модель, размер чанков, пути) повторяют настройки из 3_vector_DB/build_index.py, чтобы индекс был совместим с ботом.